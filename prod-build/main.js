/*! For license information please see main.js.LICENSE.txt */
(()=>{var __webpack_modules__={"./src/db/mongoose.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{eval('(__webpack_require__(/*! dotenv */ "dotenv").config)();\nconst mongoose = __webpack_require__(/*! mongoose */ "mongoose");\nmongoose.connect(process.env.DATABASE, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n});\n\n//# sourceURL=webpack://leaf-backend/./src/db/mongoose.js?')},"./src/index.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{eval('const express = __webpack_require__(/*! express */ "express");\nconst cors = __webpack_require__(/*! cors */ "cors");\n__webpack_require__(/*! ./db/mongoose */ "./src/db/mongoose.js");\nconst app = express();\nconst userRoutes = __webpack_require__(/*! ./routes/user */ "./src/routes/user.js");\napp.use(express.json());\napp.use(cors());\napp.use(userRoutes);\napp.listen(8000, () => {\n  console.log(\'working on port 8000\');\n});\n\n//# sourceURL=webpack://leaf-backend/./src/index.js?')},"./src/models/User.js":(module,__unused_webpack_exports,__webpack_require__)=>{eval('const mongoose = __webpack_require__(/*! mongoose */ "mongoose");\nconst validator = __webpack_require__(/*! validator */ "validator");\nconst bcrypt = __webpack_require__(/*! bcrypt */ "bcrypt");\nconst userSchema = new mongoose.Schema({\n  name: {\n    type: String,\n    required: true,\n    trim: true,\n    minlength: 2\n  },\n  business_name: {\n    type: String,\n    required: true,\n    trim: true,\n    minlength: 2\n  },\n  email: {\n    type: String,\n    required: true,\n    trim: true,\n    unique: true,\n    validate(value) {\n      if (!validator.isEmail(value)) {\n        throw new Error(\'Not valid email\');\n      }\n      return true;\n    }\n  },\n  password: {\n    type: String,\n    required: true,\n    trim: true,\n    minlength: 6\n  }\n});\nuserSchema.statics.findByCredentials = async (email, password) => {\n  const user = await User.findOne({\n    email\n  });\n  if (!user) {\n    throw new Error("user not found");\n  }\n  const isMatch = await bcrypt.compare(password, user.password);\n  if (!isMatch) {\n    throw new Error("InValid Credentials");\n  }\n  return user;\n};\nuserSchema.pre("save", async function (next) {\n  const user = this;\n  if (user.isModified(\'password\')) {\n    user.password = await bcrypt.hash(user.password, 8);\n  }\n  next();\n});\nconst User = mongoose.model(\'User\', userSchema);\nmodule.exports = User;\n\n//# sourceURL=webpack://leaf-backend/./src/models/User.js?')},"./src/routes/user.js":(module,__unused_webpack_exports,__webpack_require__)=>{eval('const express = __webpack_require__(/*! express */ "express");\nconst User = __webpack_require__(/*! ../models/User */ "./src/models/User.js");\nconst bcrypt = __webpack_require__(/*! bcrypt */ "bcrypt");\n// const router = \nconst router = new express.Router();\nrouter.post(\'/api/signup\', async (req, res) => {\n  const user = new User(req.body);\n  try {\n    await user.save();\n    res.status(201).send(user);\n  } catch (error) {\n    if (error.code === 11000) {\n      return res.status(400).send({\n        status: 400,\n        message: "Email Already exists"\n      });\n    }\n    const errors = handleErrors(error);\n    res.status(400).send({\n      status: 401,\n      message: errors.message\n    });\n  }\n});\nrouter.post(\'/api/login\', async (req, res) => {\n  try {\n    const user = await User.findByCredentials(req.body.email, req.body.password);\n    res.send(user);\n  } catch (e) {\n    res.status(400).send();\n  }\n});\nconst handleErrors = err => {\n  const errors = {\n    email: \'\'\n  };\n  Object.values(err.errors).forEach(errEle => {\n    errProperties = errEle.properties;\n    errors["message"] = errProperties.message;\n  });\n  return errors;\n};\nmodule.exports = router;\n\n//# sourceURL=webpack://leaf-backend/./src/routes/user.js?')},bcrypt:e=>{"use strict";e.exports=require("bcrypt")},cors:e=>{"use strict";e.exports=require("cors")},dotenv:e=>{"use strict";e.exports=require("dotenv")},express:e=>{"use strict";e.exports=require("express")},mongoose:e=>{"use strict";e.exports=require("mongoose")},validator:e=>{"use strict";e.exports=require("validator")}},__webpack_module_cache__={};function __webpack_require__(e){var r=__webpack_module_cache__[e];if(void 0!==r)return r.exports;var s=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](s,s.exports,__webpack_require__),s.exports}var __webpack_exports__=__webpack_require__("./src/index.js")})();